# Updated:   2026-01-29
# Build the image with:
# docker build -t meshcz-fuseki-slim ./fuseki

FROM debian:stable-slim

ARG DEBIAN_FRONTEND=noninteractive
ENV LANG=C.UTF-8

# Install dependencies
RUN apt-get update && \
    apt-get install -y curl unzip && \
    rm -rf /var/lib/apt/lists/*

RUN apt-get update && apt-get install -y --no-install-recommends \
    curl \
    && curl -Lo /tmp/amazon-corretto.deb https://corretto.aws/downloads/latest/amazon-corretto-21-x64-linux-jdk.deb \
    && apt-get install -y --no-install-recommends /tmp/amazon-corretto.deb \
    && rm /tmp/amazon-corretto.deb \
    && rm -rf /var/lib/apt/lists/*

# Jena and Fuseki versions
ENV JENA_VERSION=5.6.0
ENV JENA_HOME=/jena
ENV FUSEKI_HOME=/jena-fuseki
ENV FUSEKI_BASE=/fuseki/data
ENV PATH="${JENA_HOME}/bin:${FUSEKI_HOME}:${PATH}"

# Download and extract Jena + Fuseki
RUN curl -L -o /tmp/jena.zip https://downloads.apache.org/jena/binaries/apache-jena-${JENA_VERSION}.zip \
    && curl -L -o /tmp/fuseki.zip https://downloads.apache.org/jena/binaries/apache-jena-fuseki-${JENA_VERSION}.zip \
    && unzip /tmp/jena.zip -d / \
    && unzip /tmp/fuseki.zip -d / \
    && mv /apache-jena-${JENA_VERSION} /jena \
    && mv /apache-jena-fuseki-${JENA_VERSION} /jena-fuseki \
    && rm /tmp/jena.zip /tmp/fuseki.zip

# Expose the Fuseki port
EXPOSE 3030
